#pragma config(Sensor, S1,     tactil,         sensorEV3_Touch)
#pragma config(Sensor, S2,     giro,           sensorEV3_Gyro)
#pragma config(Sensor, S3,     color,          sensorEV3_Color)
#pragma config(Sensor, S4,     ultrasonico,    sensorEV3_Ultrasonic)
#pragma config(Motor,  motorA,          MotorIzq,      tmotorEV3_Large, PIDControl, driveLeft, encoder)
#pragma config(Motor,  motorB,           ,             tmotorEV3_Large, openLoop)
#pragma config(Motor,  motorC,           ,             tmotorEV3_Large, openLoop)
#pragma config(Motor,  motorD,          MotorDer,      tmotorEV3_Large, PIDControl, driveRight, encoder)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

void longitud(int repeticiones)     ///Repeticiones salio de la variable boton
{
	resetBumpedValue(tactil);
	int contador=0;
	float longitud;
	eraseDisplay();
  displayCenteredBigTextLine(6, "Longitud");
  wait1Msec(2000);
  eraseDisplay();
  while(contador<repeticiones)
  {
  	while(getTouchValue(tactil)==0)
  	{
  		displayCenteredTextLine(3, "Cuando desee hacer la medida,");
  		displayCenteredTextLine(5, "presione el");
  		displayCenteredTextLine(7, "sensor tactil.");
		}
		longitud=getUSDistance(ultrasonico);
		eraseDisplay();
		wait1Msec(2000);
  	contador++;
	}
	resetBumpedValue(tactil);
	while(getTouchValue(tactil)==0)
	{
		displayCenteredTextLine(5, "Distancia: %.2f cm",longitud);
		displayCenteredTextLine(7, "Presione el sensor");
		displayCenteredTextLine(9, "tactil para salir.");
	}
  eraseDisplay();
}

void area(int repeticiones)
{
  resetBumpedValue(tactil);
	int contador=0, num=1;
	float longitud, area=1;
	eraseDisplay();
  displayCenteredBigTextLine(6, "Area");
  wait1Msec(2000);
  eraseDisplay();
  while(contador<repeticiones)
  {
  	while(getTouchValue(tactil)==0)
  	{
  		displayCenteredTextLine(3, "Para hacer la medida %d,", num);
  		displayCenteredTextLine(5, "presione el");
  		displayCenteredTextLine(7, "sensor tactil.");
		}
		longitud=getUSDistance(ultrasonico);
		area=area*longitud;
		eraseDisplay();
		displayCenteredTextLine(6, "Medida %d: %.2f",num, longitud);
		wait1Msec(2000);
		eraseDisplay();
  	contador++;
  	num++;
	}
	resetBumpedValue(tactil);
	eraseDisplay();
	while(getTouchValue(tactil)==0)
	{
		displayCenteredTextLine(5, "Area: %.2f cm^2",area);
		displayCenteredTextLine(7, "Presione el sensor");
		displayCenteredTextLine(9, "tactil para salir.");
	}
  eraseDisplay();
}

void volumen(int repeticiones)
{
  resetBumpedValue(tactil);
	int contador=0, num=1;
	float longitud, volumen=1;
	eraseDisplay();
  displayCenteredBigTextLine(6, "Volumen");
  wait1Msec(2000);
  eraseDisplay();
  while(contador<repeticiones)
  {
  	while(getTouchValue(tactil)==0)
  	{
  		displayCenteredTextLine(3, "Para hacer la medida %d,", num);
  		displayCenteredTextLine(5, "presione el");
  		displayCenteredTextLine(7, "sensor tactil.");
		}
		longitud=getUSDistance(ultrasonico);
		volumen =volumen*longitud;
		eraseDisplay();
		displayCenteredTextLine(6, "Medida %d: %.2f",num, longitud);
		wait1Msec(2000);
		eraseDisplay();
  	contador++;
  	num++;
	}
	resetBumpedValue(tactil);
	eraseDisplay();
	while(getTouchValue(tactil)==0)
	{
		displayCenteredTextLine(5, "Volumen: %.2f cm^3",volumen);
		displayCenteredTextLine(7, "Presione el sensor");
		displayCenteredTextLine(9, "tactil para salir.");
	}
  eraseDisplay();
}


task main()
{
 	int boton=0;

	displayCenteredBigTextLine(1, "Medidor de");
 	displayCenteredBigTextLine(6, "longitud,");
 	displayCenteredBigTextLine(11, "area y volumen");
  wait1Msec(5000);

  while(boton!=4)
  {
  	eraseDisplay();

  	displayCenteredTextLine(1, "Instrucciones");
  	displayCenteredTextLine(2, "Presione los botones:");
  	displayCenteredTextLine(4, "-Boton Izquierdo: longitud");
  	displayCenteredTextLine(8, "-Boton Central: area");
  	displayCenteredTextLine(11, "-Boton Derecho: volumen");
  	displayCenteredTextLine(14, "-Boton Abajo: salir");
  	while(true)
  	{
  		if (getButtonPress(buttonLeft)==1)
  		{
  			boton=1;
  			break;
  		}
  		else if(getButtonPress(buttonEnter)==1)
  		{
  			boton=2;
  			break;
  		}
  		else if(getButtonPress(buttonRight)==1)
  		{
  			boton=3;
  			break;
  		}
  		else if(getButtonPress(buttonDown)==1)
  		{
  			boton=4;
  			break;
  		}
  		else if(getButtonPress(buttonUp)==1)
  		{
  			boton=8;
  			break;
  		}
  	}

  	switch (boton)
  	{
  	case 1:
    	longitud(boton);
  	break;

  	case 2:
  		area(boton);
  		eraseDisplay();
  	break;

  	case 3:
  		volumen(boton);
  		eraseDisplay();
  	case 4:
  		///Este caso esta vacio pues es el que sale del programa
  	break;

  	default:
  		eraseDisplay();
  		while(getTouchValue(tactil)==0)
  		{
  			displayCenteredTextLine(5, "Opcion invalida");
  			displayCenteredTextLine(6, "Presione un boton valido");
  			displayCenteredTextLine(8, "Presione el sensor");
  			displayCenteredTextLine(10, "tactil para continuar.");

  		}
  	}

	}

	eraseDisplay();
	displayCenteredBigTextLine(6, "Programa");
	displayCenteredBigTextLine(8, "terminado");
	wait1Msec(3000);


}
